{% extends 'base.html.twig' %}

{% block title %}{{ produit }}{% endblock %}

{% block body %}
<h1 class="center titre">{{ produit }}</h1>

<section id="show-shop-box">
    <div>
        <img src="{{ asset(produit.image) }}" alt="image produit">
    </div>
    <div id="show-shop-descri">
        <p>{{ produit.description }}</p>
        <p>
            Taille : {{ produit.taille }}<br>
            Categorie : {{ produit.categorie }}<br>
            Prix : <span class="price">{{ produit.prix }} â‚¬</span><br>
        </p>
        <div>
            <a><i class="fa-solid fa-screwdriver fa-2xl"></i></a>
            <a><i class="fa-regular fa-heart fa-2xl"></i></a>
            <a><i class="fa-solid fa-cart-shopping fa-2xl"></i></a>
        </div>
    </div>
</section>
<section id="show-shop-star">
    <div>
    {% if app.user %}
        {% if vote != null %}
        {% set note = app.user.etoiles.values.0.note %}
            {% for i in 1..5 %}
                {% if i <= note %}
                    <a class="star-gray" href="{{ path("edit_etoile", {'slug':produit.slug, 'note':i}) }}"><i class="fa-solid fa-star fa-2xl star" id="star{{ i }}"></i>  </a>
                {% else %}
                    <a class="star-gray" href="{{ path("edit_etoile", {'slug':produit.slug, 'note':i}) }}"><i class="fa-solid fa-star fa-2xl star-gray" id="star{{ i }}"></i>  </a>
                {% endif %}
            {% endfor %}
        {% endif %}
    
        {% if vote == null %}
            <a class="star-gray" href="{{ path("app_etoile", {'slug':produit.slug, 'note':1}) }}"><i class="fa-solid fa-star fa-2xl star" id="star1"></i>  </a>
            <a class="star-gray" href="{{ path("app_etoile", {'slug':produit.slug, 'note':2}) }}"><i class="fa-solid fa-star fa-2xl star" id="star2"></i>  </a>
            <a class="star-gray" href="{{ path("app_etoile", {'slug':produit.slug, 'note':3}) }}"><i class="fa-solid fa-star fa-2xl star" id="star3"></i>  </a>
            <a class="star-gray" href="{{ path("app_etoile", {'slug':produit.slug, 'note':4}) }}"><i class="fa-solid fa-star fa-2xl star" id="star4"></i>  </a>
            <a class="star-gray" href="{{ path("app_etoile", {'slug':produit.slug, 'note':5}) }}"><i class="fa-solid fa-star fa-2xl star" id="star5"></i>  </a>
        {% endif %}
    {% endif %}    
    </div>
    <p>{{ produit.etoiles|length }} {{ (produit.etoiles|length > 1) ? "votes" : "vote" }} (note : {{ produit.averageEtoiles }} / 5)</p>
</section>
<hr>
<section>
    <h2 class="center">Commentaires</h2>
    
    {% if app.user %}
    <div class="center">
        {{ form_start(commentaireForm) }}
        {{ form_widget(commentaireForm.commentaire) }}
        {{ form_end(commentaireForm) }}
    </div>
    {% endif %}
    <div id="show-shop-comment">
    {% for comment in produit.commentaires %}
        {% if comment.isActive %}
        <div>
            <p><i class="fa-solid fa-circle-user"></i> <strong>{{ comment.user }}</strong> ({{ comment.createdAt|date('d-m-Y') }}) : <br> {{ comment }}</p>
        </div>
        {% endif %}
    {% endfor %}
    </div>
</section>
{% endblock %}

{% block javascripts %}
<script src="{{ asset('js/etoile.js') }}"></script>
{% endblock %}